# # external
# server {
# 	listen 80;
# 	listen [::]:80;
# 	server_name hideout.hass.cyber0s8.net;
# 
# 	location / {
# 		proxy_http_version 1.1;
# 		proxy_set_header Host $host;
# 		proxy_set_header X-Real-IP $remote_addr;
# 		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
# 		proxy_set_header X-Forwarded-Proto $scheme;
# 		proxy_set_header Upgrade $http_upgrade;
# 		proxy_set_header Connection "upgrade";
# 		proxy_pass http://homeassistant:8123;
# 	}
# }
# 
# server {
# 	listen 80;
# 	listen [::]:80;
# 	server_name hideout.ocpr.cyber0s8.net;
# 
# 	location / {
# 		proxy_pass http://construct-pcu/;
# 		proxy_http_version 1.1;
# 		proxy_set_header Host $http_host;
# 		proxy_set_header Upgrade $http_upgrade;
# 		proxy_set_header Connection "upgrade";
# 		proxy_set_header X-Real-IP $remote_addr;
# 		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
# 		proxy_set_header X-Scheme $scheme;
# 
# 		client_max_body_size 0;    
# 	}
# }
# 
# server {
# 	listen 80;
# 	listen [::]:80;
# 	server_name hideout.adg.cyber0s8.net;
# 
# 	location / {
# 		proxy_pass http://adguard:80;
# 	}
# }
# 
# server {
# 	listen 80;
# 	listen [::]:80;
# 	server_name 3dwatcher.cyber0s8.net w4tch3r.cyber0s8.net;
# 
# 	location / {
# 		proxy_pass http://construct-pcu:80/webcam/?action=stream;
# 	}
# }

server {

	listen 80;
	listen [::]:80;
	server_name hass.cyber0s8.net;

	location / {
		proxy_pass http://homeassistant:8123;
		proxy_http_version 1.1;
		proxy_set_header Host $http_host;
		proxy_set_header Upgrade $http_upgrade;
		proxy_set_header Connection "upgrade";
		proxy_set_header X-Real-IP $remote_addr;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header X-Scheme $scheme;

		client_max_body_size 0;    
	}
}

server {
	listen 443 ssl;
	listen [::]:443 ssl;
	server_name hass.cyber0s8.net;

	ssl_certificate /etc/nginx/ssl/fullchain.cer;
	ssl_certificate_key /etc/nginx/ssl/cyber0s8.net.key;

	location / {
		proxy_pass http://homeassistant:8123;
		proxy_http_version 1.1;
		proxy_set_header Host $http_host;
		proxy_set_header Upgrade $http_upgrade;
		proxy_set_header Connection "upgrade";
		proxy_set_header X-Real-IP $remote_addr;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header X-Scheme $scheme;

		client_max_body_size 0;    
	}
}

server {

	listen 80;
	listen [::]:80;
	server_name adg.cyber0s8.net;

	# return 301 https://$host$request_uri;
	location / {
		proxy_pass http://adguard:80;
		proxy_http_version 1.1;
		proxy_set_header Host $http_host;
		proxy_set_header Upgrade $http_upgrade;
		proxy_set_header Connection "upgrade";
		proxy_set_header X-Real-IP $remote_addr;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header X-Scheme $scheme;

		client_max_body_size 0;    
	}
}

server {
	listen 443 ssl;
	listen [::]:443 ssl;
	server_name adg.cyber0s8.net;

	ssl_certificate /etc/nginx/ssl/fullchain.cer;
	ssl_certificate_key /etc/nginx/ssl/cyber0s8.net.key;

	location / {
		proxy_pass http://adguard:80;
		proxy_http_version 1.1;
		proxy_set_header Host $http_host;
		proxy_set_header Upgrade $http_upgrade;
		proxy_set_header Connection "upgrade";
		proxy_set_header X-Real-IP $remote_addr;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header X-Scheme $scheme;

		client_max_body_size 0;    
	}
}

#internal
server {
	listen 53 default_server;
	listen [::]:53 default_server;
	server_name hideout-ccu;

	location / {
		proxy_pass $scheme://adguard:53;
	}
}

server {
	listen 8080;
	listen [::]:8080;
	server_name hideout-ccu;

	location / {
		proxy_pass $scheme://zigbee2mqtt:8080;
		# proxy_set_header Host $host;
		# proxy_set_header X-Real-IP $remote_addr;
		# proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
	}

	location /api {
		proxy_pass $scheme://zigbee2mqtt:8080/api;
		# proxy_http_version 1.1;
		# proxy_set_header Host $host;
		# proxy_set_header Upgrade $http_upgrade;
		# proxy_set_header Connection "upgrade";
	}
}


server {
	listen 80 default_server;
	listen [::]:80 default_server;
	server_name _;

	location / {
		proxy_pass $scheme://homeassistant:8123;
		proxy_http_version 1.1;
		proxy_set_header Host $host;
		proxy_set_header X-Real-IP $remote_addr;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header X-Forwarded-Proto $scheme;
		proxy_set_header Upgrade $http_upgrade;
		proxy_set_header Connection "upgrade";
	}
}
